<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragment/layout}">

<!-- ğŸ‘‡ ì—¬ê¸°ì„œ errorCodeë¥¼ data-error-codeë¡œ safely ì „ë‹¬ -->
<body th:attr="data-error-code=${errorCode}">

<th:block layout:fragment="css">
    <link rel="stylesheet" href="/css/login.css" />
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet" />
</th:block>

<section layout:fragment="content" id="container" class="sub login-page">
    <div class="login-container">
        <div class="login_box">
            <h1>íšŒì› ë¡œê·¸ì¸</h1>
            <form th:action="@{/api/member/loginProc}" method="POST">
                <div class="input_group">
                    <label for="userid">ì•„ì´ë””</label>
                    <input type="text" id="userid" name="userid" placeholder="ì•„ì´ë””" required />
                </div>
                <div class="input_group">
                    <label for="pwd">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="pwd" name="pwd" placeholder="ë¹„ë°€ë²ˆí˜¸" required />
                </div>
                <button type="submit" class="login_button">ë¡œê·¸ì¸</button>
            </form>

            <div class="links">
                <a href="/api/member/findidpw#tab1">ì•„ì´ë”” ì°¾ê¸°</a> |
                <a href="/api/member/findidpw#tab2">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</a> |
                <a href="/api/member/join">íšŒì›ê°€ì…</a>
            </div>

            <div class="sns-icons">
                <a href="https://kauth.kakao.com/oauth/authorize?client_id=3a729b684852129622871e6b959a97e6&redirect_uri=http://localhost:8090/api/member/kakao&response_type=code">
                    ì¹´ì¹´ì˜¤ë¡œ ë¡œê·¸ì¸
                </a>
            </div>
        </div>
    </div>
</section>

<th:block layout:fragment="js">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const errorCode = document.body.dataset.errorCode;
            console.log("errorCode from body dataset:", errorCode);

            const messages = {
                BAD_CREDENTIALS: "ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.",
                WITHDRAW: "íƒˆí‡´í•œ íšŒì›ì…ë‹ˆë‹¤.",
                STOP: "íœ´ë¨¼ ê³„ì •ì…ë‹ˆë‹¤."
            };

            if (errorCode === 'WITHDRAW' || errorCode === 'STOP') {
                Swal.fire({
                    icon: 'error',
                    title: "ë¡œê·¸ì¸ ì‹¤íŒ¨",
                    text: messages[errorCode] || "ë¡œê·¸ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.",
                });
            }
        });
    </script>
</th:block>

</body>
</html>
